<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>å°å¤ªé˜³ç”Ÿæ—¥å¿«ä¹</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"KaiTi",KaiTi,serif}
body{background:#fdf6f9;overflow-x:hidden;position:relative}
#fireworks{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:1;pointer-events:none}

/* æµ®åŠ¨æ°”çƒ */
.balloon{position:fixed;z-index:2;pointer-events:none;font-size:28px;animation:floatUp linear forwards}
@keyframes floatUp{0%{transform:translateY(100vh) rotate(0deg)}100%{transform:translateY(-100px) rotate(15deg)}}

/* é£˜è½æ˜Ÿæ˜Ÿçˆ±å¿ƒ */
.fall{position:fixed;z-index:3;pointer-events:none;font-size:20px;animation:falling linear forwards}
@keyframes falling{0%{transform:translateY(-10px) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(360deg);opacity:0}}

/* ä¸»å°é¢ */
.cover{position:fixed;top:0;left:0;width:100vw;height:100vh;background:linear-gradient(160deg,#ffebf2,#ffe6f0,#ffd6e7);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999}
.cover h1{font-size:36px;color:#e91e63;margin-bottom:20px}
.cover p{font-size:20px;color:#c71585;margin-bottom:30px}
#openBtn{background:#e91e63;color:white;border:none;border-radius:40px;padding:14px 36px;font-size:18px;cursor:pointer;transition:.3s}
#openBtn:hover{transform:scale(1.08);box-shadow:0 0 20px rgba(233,30,99,0.3)}

/* ä¼˜åŒ–åçš„ç”Ÿæ—¥ä¸»é¢˜å¼¹çª— */
.bubble{
    position:fixed;
    width:240px;
    padding:16px 12px;
    border-radius:16px;
    background:linear-gradient(135deg, #fff0f6, #ffebf2);
    box-shadow:0 8px 24px rgba(233,30,99,0.18);
    border:1px solid #ffc0cb;
    z-index:10;
    text-align:center;
    animation:pop .5s ease forwards, float 4s infinite ease-in-out;
    overflow:hidden;
}
/* å¼¹çª—è£…é¥°è§’æ ‡ */
.bubble::before{
    content:"ğŸ‚";
    position:absolute;
    top:6px;
    right:8px;
    font-size:18px;
}
/* ç‰¹æ®Šç¥ç¦å¼¹çª—æ ·å¼å¼ºåŒ– */
.bubble.special{
    background:linear-gradient(135deg, #ffe6f0, #ffd6e7);
    box-shadow:0 8px 24px rgba(233,30,99,0.25);
    border:1px solid #ff69b4;
}
.bubble.special::before{
    content:"ğŸ‰";
    font-size:20px;
}

@keyframes pop{
    0%{transform:scale(0);opacity:0}
    70%{transform:scale(1.05);opacity:1}
    100%{transform:scale(1);opacity:1}
}
@keyframes float{
    0%,100%{transform:translateY(0)}
    50%{transform:translateY(-6px)}
}

.bubble .txt{
    font-size:16px;
    color:#333;
    line-height:1.5;
    padding-right:24px; /* ç»™è§’æ ‡ç•™ç©ºé—´ */
}
/* æ–°å¢ï¼šå¼¹çª—å…³é—­æŒ‰é’® */
.bubble .close{
    position:absolute;
    top:4px;
    left:8px;
    font-size:16px;
    color:#e91e63;
    cursor:pointer;
    width:20px;
    height:20px;
    line-height:20px;
    display:none; /* é»˜è®¤éšè—ï¼Œç»“æŸçŠ¶æ€æ˜¾ç¤º */
}
.bubble.keep .close{
    display:block; /* ä¿ç•™çš„å¼¹çª—æ˜¾ç¤ºå…³é—­æŒ‰é’® */
}
.bubble .close:hover{
    color:#c71585;
}

/* ç»“æŸçŠ¶æ€æç¤º */
.end-tip{
    position:fixed;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    background:rgba(255,255,255,0.95);
    padding:12px 24px;
    border-radius:30px;
    font-size:18px;
    color:#e91e63;
    box-shadow:0 4px 12px rgba(233,30,99,0.15);
    z-index:999;
    opacity:0;
    transition:opacity 0.5s ease;
}
.end-tip.show{
    opacity:1;
}

/* éŸ³ä¹æŒ‰é’® */
#musicBtn{
    position:fixed;
    bottom:24px;
    right:24px;
    width:52px;
    height:52px;
    border-radius:50%;
    background:#e91e63;
    color:white;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:22px;
    z-index:999;
    border:none;
    box-shadow:0 0 15px rgba(233,30,99,0.4);
    cursor:pointer;
}

/* ç‚¹å‡»ç‰¹æ•ˆ */
.heart{
    position:fixed;
    font-size:30px;
    pointer-events:none;
    z-index:99;
    animation:boom .6s ease forwards;
}
@keyframes boom{
    0%{transform:scale(0);opacity:1}
    50%{transform:scale(1.3);opacity:.9}
    100%{transform:scale(0);opacity:0}
}
</style>
</head>

<body>
<canvas id="fireworks"></canvas>
<div class="cover" id="cover">
    <h1>ğŸ‚ ç”Ÿæ—¥å¿«ä¹ ğŸ‚</h1>
    <p>ç‚¹å‡»å¼€å¯ï¼Œæ¥æ”¶ä¸€æ•´å¹´çš„å¥½è¿ä¸å¹¸ç¦</p>
    <button id="openBtn">å¼€å¯æƒŠå–œç¥ç¦</button>
</div>

<!-- ç»“æŸçŠ¶æ€æç¤º -->
<div class="end-tip" id="endTip">ğŸŠ ç¥ç¦æ´¾é€å®Œæ¯•ï¼ç‚¹å‡»å¼¹çª—Ã—å¯å…³é—­å“¦ï½</div>

<button id="musicBtn">ğŸµ</button>

<script>
const nickname = "zz";
const cover = document.getElementById("cover");
const openBtn = document.getElementById("openBtn");
const musicBtn = document.getElementById("musicBtn");
const endTip = document.getElementById("endTip");
const canvas = document.getElementById("fireworks");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

// é€‚é…çª—å£å¤§å°å˜åŒ–
window.addEventListener('resize', () => {
    canvas.width = innerWidth;
    canvas.height = innerHeight;
});

// èƒŒæ™¯éŸ³ä¹
let audio = new Audio("https://music.163.com/song/media/outer/url?id=186017.mp3");
audio.loop = true;
audio.volume = 0.5;
let musicOn = false;
musicBtn.onclick = ()=>{
    if(musicOn){
        audio.pause();
        musicBtn.textContent="ğŸµ";
    } else {
        audio.play().catch(() => {
            alert("éœ€è¦ä½ æ‰‹åŠ¨ç‚¹å‡»ä¸€ä¸‹éŸ³ä¹æŒ‰é’®å¼€å¯éŸ³æ•ˆå“¦ï½");
        });
        musicBtn.textContent="ğŸ”‡";
    }
    musicOn = !musicOn;
};

// ç¥ç¦æ–‡æ¡ˆ
const texts = [
    `${nickname}ç”Ÿæ—¥å¿«ä¹ï¼Œæ°¸è¿œå…ƒæ°”æ»¡æ»¡ï¼`,
    `æ–°çš„ä¸€å²ï¼Œæš´å¯Œæš´ç¾ï¼Œä¸‡äº‹é¡ºæ„ï¼`,
    `æ„¿ä½ è¢«çˆ±åŒ…å›´ï¼Œå¹³å®‰å–œä¹ï¼Œå²å²æ— å¿§ï¼`,
    `ç”Ÿæ´»æ˜æœ—ï¼Œä¸‡ç‰©å¯çˆ±ï¼Œç”Ÿæ—¥å¿«ä¹å‘€ï¼`,
    `æ‰€æœ‰ç¾å¥½å¦‚æœŸè€Œè‡³ï¼Œæ‰€æœ‰æ„¿æœ›çš†å¯å®ç°ï¼`,
    `åšæœ€é—ªè€€çš„è‡ªå·±ï¼Œè‡ªåœ¨å¦‚é£ï¼Œæ—¥æ—¥æ¬¢å–œï¼`,
    `å®¶äººå®‰åº·ï¼Œæœ‹å‹ç›¸ä¼´ï¼Œå¹¸ç¦æ»¡æ»¡ï¼`,
    `è›‹ç³•åƒä¸åœï¼Œå¿«ä¹ä¸æ‰“çƒŠï¼`,
    `é¢œå€¼çˆ†è¡¨ï¼Œæ™ºæ…§è¶…ç¾¤ï¼Œå¿«ä¹ç¿»å€ï¼`,
    `æ¯ä¸€ä¸ªæ„¿æœ›éƒ½èƒ½å®ç°ï¼Œè¶…å¹¸è¿ï¼`
];
const special = `ğŸ‰ ä¸“å±${nickname}çš„ç”Ÿæ—¥é™å®šï¼šå¾€åä½™ç”Ÿï¼Œå…¨æ˜¯æ¸©æŸ”ä¸å¹¸è¿ï¼`;

// éšæœºæ•°å·¥å…·å‡½æ•°
function rnd(min,max){
    return Math.floor(Math.random()*(max-min+1))+min;
}

// ç‚¹å‡»çˆ±å¿ƒ/æ˜Ÿæ˜Ÿç‰¹æ•ˆ
document.onclick = (e)=>{
    let h = document.createElement("div");
    h.className = "heart";
    h.textContent = ["ğŸ’–","âœ¨","ğŸ¥³","ğŸ‚","ğŸŒŸ","ğŸ"][rnd(0,5)];
    h.style.left = (e.clientX - 15) + "px";
    h.style.top = (e.clientY - 15) + "px";
    document.body.appendChild(h);
    setTimeout(() => h.remove(), 600);
};

// æ°”çƒç”Ÿæˆ
function balloon(){
    let b = document.createElement("div");
    b.className = "balloon";
    b.textContent = ["ğŸˆ","ğŸ","ğŸ€","ğŸ’Œ"][rnd(0,3)];
    b.style.left = rnd(20, innerWidth - 40) + "px";
    b.style.animationDuration = rnd(8,16) + "s";
    b.style.bottom = "-60px";
    document.body.appendChild(b);
    setTimeout(() => b.remove(), 16000);
}

// é£˜è½è£…é¥°
function fall(){
    let f = document.createElement("div");
    f.className = "fall";
    f.textContent = ["âœ¨","ğŸ’–","ğŸ¬","ğŸ","â­","ğŸ°"][rnd(0,5)];
    f.style.left = rnd(0, innerWidth) + "px";
    f.style.animationDuration = rnd(4,9) + "s";
    document.body.appendChild(f);
    setTimeout(() => f.remove(), 10000);
}

// ä¿å­˜éœ€è¦ä¿ç•™çš„å¼¹çª—ID
let keepBubbles = [];
let hasSpecial = false;

// ä¼˜åŒ–åçš„ç¥ç¦å¼¹çª—ï¼ˆæ”¯æŒä¿ç•™å’Œå…³é—­ï¼‰
function bubble(isKeep = false){
    let b = document.createElement("div");
    b.className = isKeep ? "bubble keep" : "bubble";
    
    // éšæœºä½ç½®ï¼ˆé¿å…é‡å ï¼‰
    let left = rnd(40, innerWidth - 280);
    let top = rnd(80, innerHeight - 140);
    b.style.left = left + "px";
    b.style.top = top + "px";
    
    // å†…å®¹å’Œæ ·å¼
    let txt = "";
    if(!hasSpecial && Math.random() < 0.1){
        txt = special;
        b.classList.add("special");
        hasSpecial = true;
        if(isKeep) keepBubbles.push(b); // ç‰¹æ®Šç¥ç¦ä¼˜å…ˆä¿ç•™
    } else {
        txt = texts[rnd(0, texts.length - 1)];
    }
    
    // ç»„è£…å¼¹çª—ï¼ˆæ–°å¢å…³é—­æŒ‰é’®ï¼‰
    b.innerHTML = `
        <span class="close">Ã—</span>
        <div class="txt">${txt}</div>
    `;
    
    // å…³é—­æŒ‰é’®äº‹ä»¶
    b.querySelector(".close").onclick = () => {
        b.style.opacity = 0;
        setTimeout(() => b.remove(), 500);
        // ç§»é™¤åæ›´æ–°ä¿ç•™åˆ—è¡¨
        keepBubbles = keepBubbles.filter(item => item !== b);
        // å…¨éƒ¨å…³é—­åéšè—æç¤º
        if(keepBubbles.length === 0){
            endTip.classList.remove("show");
        }
    };
    
    document.body.appendChild(b);
    
    // éä¿ç•™å¼¹çª—è‡ªåŠ¨æ¶ˆå¤±
    if(!isKeep){
        setTimeout(() => b.style.opacity = 0, 4000);
        setTimeout(() => b.remove(), 5000);
    }
}

// ç”Ÿæˆä¿ç•™çš„å¼¹çª—ï¼ˆç»“æŸçŠ¶æ€ï¼‰
function createKeepBubbles(){
    // é‡ç½®ç‰¹æ®Šç¥ç¦æ ‡è®°
    hasSpecial = false;
    // ç”Ÿæˆ8ä¸ªä¿ç•™å¼¹çª—ï¼ˆå«1ä¸ªç‰¹æ®Šç¥ç¦ï¼‰
    for(let i=0; i<8; i++){
        setTimeout(() => bubble(true), i*300);
    }
    // æ˜¾ç¤ºç»“æŸæç¤º
    setTimeout(() => {
        endTip.classList.add("show");
    }, 1000);
}

// çƒŸèŠ±æ•ˆæœ
function launchFirework(){
    class FW{
        constructor(){
            this.x = rnd(100, innerWidth - 100);
            this.y = rnd(80, innerHeight/2);
            this.p = [];
            this.c = `hsl(${rnd(0,360)},80%,60%)`;
            // æ›´å¤šç²’å­æ›´ç»šçƒ‚
            for(let i=0; i<120; i++){
                this.p.push({
                    x: this.x,
                    y: this.y,
                    vx: (Math.random() - .5) * 8,
                    vy: (Math.random() - .5) * 8,
                    l: 120
                });
            }
        }
        draw(){
            this.p.forEach(v => {
                ctx.beginPath();
                ctx.arc(v.x, v.y, 2.8, 0, Math.PI*2);
                ctx.fillStyle = this.c;
                ctx.fill();
            });
        }
        update(){
            this.p.forEach(v => {
                v.x += v.vx;
                v.y += v.vy;
                v.vy += 0.12;
                v.l--;
            });
            this.p = this.p.filter(v => v.l > 0);
        }
    }
    let fw = new FW();
    let itv = setInterval(() => {
        ctx.clearRect(0,0,innerWidth,innerHeight);
        fw.update();
        fw.draw();
        if(fw.p.length === 0) clearInterval(itv);
    }, 20);
}

// å¼€å¯æƒŠå–œä¸»æµç¨‹
openBtn.onclick = ()=>{
    // éšè—å°é¢
    cover.style.opacity = 0;
    setTimeout(() => cover.style.display = "none", 500);
    
    // æ’­æ”¾éŸ³ä¹
    audio.play().catch(()=>{});
    musicOn = true;
    musicBtn.textContent = "ğŸ”‡";
    
    // å¯åŠ¨åŠ¨ç”»
    launchFirework();
    setInterval(balloon, 2600);
    setInterval(fall, 600);
    
    // æ‰¹é‡ç”Ÿæˆæ™®é€šå¼¹çª—
    for(let i=0; i<88; i++){
        setTimeout(bubble, i*180);
    }
    
    // ä¸­é€”åŠ ä¸€æ³¢çƒŸèŠ±
    setTimeout(() => {
        for(let i=0; i<3; i++){
            setTimeout(launchFirework, i*600);
        }
    }, 16000);
    
    // ç»“æŸçŠ¶æ€ï¼šç”Ÿæˆä¿ç•™å¼¹çª—
    setTimeout(() => {
        createKeepBubbles();
    }, 22000);
};
</script>
</body>
</html>